---
title: ArchLinuxå®‰è£…é…ç½®æ‰‹å†Œ[ç³»ç»Ÿç¯‡]
date: 2021/08/14 21:13:48
update: 2021/09/29
categories: ArchLinux
tags:
- ArchLinux
toc: true
valine:
  placeholder: "1. æé—®å‰è¯·å…ˆä»”ç»†é˜…è¯»æœ¬æ–‡æ¡£âš¡\n2. é¡µé¢æ˜¾ç¤ºé—®é¢˜ğŸ’¥ï¼Œè¯·æä¾›æ§åˆ¶å°æˆªå›¾ğŸ“¸æˆ–è€…æ‚¨çš„æµ‹è¯•ç½‘å€\n3. å…¶ä»–ä»»ä½•æŠ¥é”™ğŸ’£ï¼Œè¯·æä¾›è¯¦ç»†æè¿°å’Œæˆªå›¾ğŸ“¸ï¼Œç¥é£Ÿç”¨æ„‰å¿«ğŸ’ª"
---
# å®‰è£…å‰çš„å‡†å¤‡
é•œåƒä¸‹è½½åœ°å€ï¼šhttps://archlinux.org/download/
:::default
æœªä½¿ç”¨è¿‡Linuxçš„ç”¨æˆ·ï¼Œå»ºè®®å…ˆäº†è§£ä¸€ä¸‹Linux
:::

# å¯åŠ¨Liveç¯å¢ƒ
ï¼ˆ1ï¼‰åˆ¶ä½œå¯åŠ¨ç›˜

å¦‚æœä½ æ˜¯Windowsç”¨æˆ·ï¼Œä½ å¯ä»¥ä½¿ç”¨Rufusæ¥åˆ¶ä½œï¼Œå…·ä½“ä½¿ç”¨æ–¹æ³•ä½ å¯ä»¥æŸ¥é˜…ä¸€ä¸‹ç™¾åº¦ã€‚

å¦‚æœä½ æ˜¯Linuxç”¨æˆ·ï¼Œä½ åªéœ€è¦ä½¿ç”¨ddå‘½ä»¤å³å¯ï¼Œç›¸ä¿¡ä½ è‚¯å®šä¼šçš„ã€‚

ï¼ˆ2ï¼‰è¿›å…¥Liveç¯å¢ƒ

é€‰æ‹©ä»å¸¦æœ‰ Arch å®‰è£…æ–‡ä»¶çš„åª’ä»‹å¯åŠ¨é€šå¸¸æ˜¯åœ¨ä½ ç”µè„‘å¼€æœºçš„æ—¶å€™æŒ‰ä¸‹æŸä¸ªæŒ‰é”®ï¼Œä¸€èˆ¬ä¼šåœ¨å¯åŠ¨ç”»é¢æœ‰æç¤ºã€‚ä¸åŒçš„ä¸»æ¿æŒ‰é”®ä¸åŒã€‚

å½“ Arch èœå•å‡ºç°æ—¶ï¼Œé€‰æ‹© Boot Arch Linux å¹¶æŒ‰ Enter è¿›å…¥å®‰è£…ç¯å¢ƒã€‚

# éªŒè¯å¯åŠ¨æ¨¡å¼ï¼ˆé‡è¦ï¼‰
å¯ä»¥åˆ—å‡º efivars ç›®å½•ä»¥éªŒè¯å¯åŠ¨æ¨¡å¼ï¼š
``` bash
ls /sys/firmware/efi/efivars
```
å¦‚æœç›®å½•ä¸å­˜åœ¨ï¼Œç³»ç»Ÿå¯èƒ½ä»¥ BIOS æˆ– CSM æ¨¡å¼å¯åŠ¨ï¼Œè¯¦è§æ‚¨çš„ä¸»æ¿æ‰‹å†Œã€‚

å¦‚æœç›®å½•å­˜åœ¨ã€‚ç³»ç»Ÿå°±æ˜¯ä»¥UEFIå¯åŠ¨ã€‚

è¯·è®°ä½ä½ çš„å¯åŠ¨æ¨¡å¼ï¼ï¼ï¼

# è¿æ¥ç½‘ç»œ
:::default
è¯·é€‰æ‹©å…¶ä¸­ä¸€ç§æ–¹å¼è¿æ¥
:::
1.è¿æ¥ç½‘çº¿
``` bash
dhcpcd
```
2.è¿æ¥WiFi
``` bash
wifi-menu
```
ç›®å‰wifi-menuè¿æ¥å·¥å…·å·²ç»è¢«ç§»é™¤ï¼Œè¯·å‚ç…§æœ€æ–°çš„wikiæ–‡æ¡£ä½¿ç”¨æ–°çš„å·¥å…·

# åˆ†åŒºæ–¹æ¡ˆ
BIOS with MBR			
|æŒ‚è½½ç‚¹|åˆ†åŒº|åˆ†åŒºç±»å‹|å»ºè®®å¤§å°|
|  :----:     | :----:  | :----:| :----:   |
|/mnt|/dev/sda1|Linux|å‰©ä½™ç©ºé—´|
|[SWAP]|/dev/sda2|Linux swap|More than 512 MiB|
UEFI with GPT			
|æŒ‚è½½ç‚¹|åˆ†åŒº|åˆ†åŒºç±»å‹|å»ºè®®å¤§å°|
|  :----:     | :----:  | :----:| :----:   |
|/mnt/boot|/dev/sda1|EFI ç³»ç»Ÿåˆ†åŒº|265â€“512 MiB|
|/mnt|/dev/sda2|Linux x86-64 root (/)|å‰©ä½™ç©ºé—´|
|[SWAP]|/dev/sda3|Linux swap|More than 512 MiB|

:::warning
åˆ†åŒºæ–¹æ¡ˆè§£è¯»ï¼šå¦‚æœä½ æ˜¯ä»¥BIOSæ¨¡å¼å¯åŠ¨ï¼Œä½ å°±æ— é¡»åˆ›å»ºå’ŒæŒ‚è½½/bootåˆ†åŒºã€‚

å¦‚æœä½ æ˜¯ä»¥UEFIæ¨¡å¼å¯åŠ¨ï¼Œé‚£ä½ å°±å¿…é¡»åˆ›å»ºå’ŒæŒ‚è½½/bootåˆ†åŒº
:::

#å¼€å§‹åˆ†åŒº
::: default
åœ¨é‚£ä¹‹å‰ï¼Œå»ºè®®ä½ å…ˆäº†è§£ä¸€ä¸‹ä»¥ä¸‹åˆ†åŒºçš„ä½œç”¨
:::
``` bash
/ #æ ¹ç›®å½•
/home #å®¶ç›®å½•
/boot #å¼•å¯¼åˆ†åŒº
swap #äº¤æ¢åˆ†åŒº
```

# æ ¼å¼åŒ–åˆ†åŒº
å½“åˆ†åŒºå»ºç«‹å¥½äº†ï¼Œè¿™äº›åˆ†åŒºéƒ½éœ€è¦ä½¿ç”¨é€‚å½“çš„æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œæ ¼å¼åŒ–
:::warning
æ³¨æ„ï¼šè¯·æ ¹æ®è‡ªå·±çš„åˆ†åŒºæƒ…å†µè¿›è¡Œå¯¹åº”çš„æ ¼å¼åŒ–,è¿™é‡Œçš„ç¡¬ç›˜åˆ†åŒºåªæ˜¯ä½œä¸ºä¾‹å­ï¼Œè¯·æ ¹æ®è‡ªå·±å®é™…æƒ…å†µè¿›è¡Œæ“ä½œ
:::
/
``` bash
mkfs.ext4 /dev/sda1
```
/home
``` bash
mkfs.ext4 /dev/sda2
```
/bootï¼ˆBIOSå¯åŠ¨çš„ä¸éœ€è¦)
```bash
mkfs.fat -F32 /dev/sda3
```
swap
``` bash
mkswap /dev/sda4
swapon /dev/sda4
```
# æŒ‚è½½åˆ†åŒº
/
å°†/åˆ†åŒºæŒ‚è½½åˆ°/mnt
``` bash
mount /dev/sda1 /mnt
```
/home
/mntä¸‹åˆ›å»º/homeæ–‡ä»¶
``` bash
mkdir /mnt/home
```
æŒ‚è½½/homeåˆ†åŒº
``` bash
mount /dev/sda2 /mnt/home
```
/bootï¼ˆBIOSå¯åŠ¨çš„ä¸éœ€è¦ï¼‰
/mntä¸‹åˆ›å»º/boot
``` bash
mkdir /mnt/boot
```
æŒ‚è½½å¼•å¯¼åˆ†åŒº
``` bash
mount /dev/sda3 /mnt/boot
```
å®‰è£…åŸºç¡€è½¯ä»¶åŒ…
base è½¯ä»¶åŒ…å¹¶æ²¡æœ‰åŒ…å«å…¨éƒ¨ live ç¯å¢ƒä¸­çš„ç¨‹åºï¼Œpackages.x86_64 é¡µé¢åŒ…å«äº†å®ƒä»¬çš„å·®å¼‚ã€‚éœ€è¦é¢å¤–å®‰è£…ï¼š

ç®¡ç†æ‰€ç”¨æ–‡ä»¶ç³»ç»Ÿ çš„ç”¨æˆ·å·¥å…·
è®¿é—® RAID æˆ– LVM åˆ†åŒºçš„å·¥å…·
æœªåŒ…å«åœ¨ linux-firmware ä¸­çš„é¢å¤–å›ºä»¶
è”ç½‘éœ€è¦çš„ç¨‹åº
æ–‡æœ¬ç¼–è¾‘å™¨,
è®¿é—® man å’Œ info é¡µé¢çš„å·¥å…·ï¼š man-db, man-pages å’Œ texinfo.
å¦‚æœä½ è¿˜æƒ³å®‰è£…å…¶ä»–è½¯ä»¶åŒ…ç»„æ¯”å¦‚ base-develï¼Œè¯·å°†ä»–ä»¬çš„åå­—æ·»åŠ åˆ° pacstrap åï¼Œå¹¶ç”¨ç©ºæ ¼éš”å¼€ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨ #Chroot ä¹‹åä½¿ç”¨ pacman æ‰‹åŠ¨å®‰è£…è½¯ä»¶åŒ…æˆ–ç»„ã€‚
:::default
å¦‚æœä½ çœ‹ä¸æ‡‚ä¸Šé¢åœ¨è¯´ä»€ä¹ˆï¼Œé‚£ä½ è·Ÿç€æˆ‘è¿è¡Œä¸‹é¢çš„å‘½ä»¤å°±è¡Œäº†
:::
``` bash
pacstrap /mnt base linux linux-firmware base-devel vi vim nano dhcpcd
```
# é…ç½®ç³»ç»Ÿ
Fstab
ç”¨ä»¥ä¸‹å‘½ä»¤ç”Ÿæˆ fstab æ–‡ä»¶ (ç”¨ -U æˆ– -L é€‰é¡¹è®¾ç½®UUID æˆ–å·æ ‡)ï¼š
``` bash
genfstab -U /mnt >> /mnt/etc/fstab
```
Change root åˆ°æ–°å®‰è£…çš„ç³»ç»Ÿï¼š
```bash
arch-chroot /mnt
```
è®¾ç½®æ—¶åŒº
```bash
ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
hwclock --systohc
```
æœ¬åœ°åŒ–è®¾ç½®
/etc/locale.gen æ˜¯ä¸€ä¸ªä»…åŒ…å«æ³¨é‡Šæ–‡æ¡£çš„æ–‡æœ¬æ–‡ä»¶ã€‚æŒ‡å®šæ‚¨éœ€è¦çš„æœ¬åœ°åŒ–ç±»å‹ï¼Œåªéœ€ç§»é™¤å¯¹åº”è¡Œå‰é¢çš„æ³¨é‡Šç¬¦å·ï¼ˆï¼ƒï¼‰å³å¯ï¼Œå»ºè®®é€‰æ‹©å¸¦ UTF-8 çš„é¡¹ï¼š
```bash
vim /etc/locale.gen
en_US.UTF-8 UTF-8 #å»æ‰å¯¹åº”ç¼–ç å‰é¢çš„äº•å·
zh_CN.UTF-8 UTF-8
```
ä¿å­˜é€€å‡º
æ¥ç€æ‰§è¡Œ locale-gen ä»¥ç”Ÿæˆ locale è®¯æ¯ï¼š
```bash
locale-gen
```
å°† LANG=en_US.UTF-8 åŠ å…¥ /etc/locale.conf
```bash
vim /etc/locale.conf
```
è®¾ç½®ä¸»æœºå
xxxxsæ˜¯ä½ çš„ä¸»æœºåï¼ˆè‡ªå·±å–ä¸ªå–œæ¬¢çš„åå­—ï¼‰
```bash
echo "xxxx" >> /etc/hostname
```
è®¾ç½®rootå¯†ç 
ä½¿ç”¨passwdå‘½ä»¤ä¸ºrootç”¨æˆ·å¢åŠ å¯†ç 
```bash
passwd
```
å®‰è£…Intel-ucodeï¼ˆéInter C PUä¸éœ€è¦ï¼‰
```bash
pacman -S intel-ucode
```
:::default
å¦‚æœä½ çš„ä¸‹è½½å‡ºé”™ï¼Œå¯èƒ½æ˜¯ç½‘ç»œæ–­å¼€äº†ï¼Œé‚£å°±å†è¿æ¥ä¸€æ¬¡ç½‘ç»œå³å¯
:::
å®‰è£…å¼•å¯¼
å¦‚æœä½ ç¡¬ç›˜ä¸Šè¿˜æœ‰åˆ«çš„ç³»ç»Ÿï¼Œéœ€è¦å®‰è£… os-proberã€‚å¦‚æœä½ çš„ç³»ç»Ÿåœ¨åˆ«çš„ç¡¬ç›˜å•ç‹¬å¼•å¯¼ï¼Œåˆ™ä¸éœ€è¦ã€‚
```bash
pacman -S os-prober
```
å¯¹äº BIOS ç³»ç»Ÿï¼š
```bash
pacman -S grub
grub-install --target=i386-pc /dev/sdX    # sdX ä¸ºä½ çš„å®‰è£…ç¡¬ç›˜
grub-mkconfig -o /boot/grub/grub.cfg
```
å¯¹äº UEFI ç³»ç»Ÿï¼š
```bash
pacman -S grub efibootmgr
grub-install --target=x86_64-efi --efi-directory=/boot --bootloader-id=GRUB
grub-mkconfig -o /boot/grub/grub.cfg
```
# é‡å¯
:::default
ç³»ç»Ÿåˆ°è¿™é‡Œå°±å®‰è£…å®Œæ¯•äº†
:::
```bash
exit
umount -R /mnt
reboot
```

:::default
ç³»ç»Ÿçš„ç¾åŒ–å°±ä¸åšè¿‡å¤šçš„èµ˜è¿°ï¼Œå› ä¸ºå¯ä¾›çš„é€‰æ‹©å¤ªå¤šï¼Œä¾‹å¦‚KDEï¼ŒGNOMEï¼ŒMATEï¼Œi3ï¼Œdwmï¼Œopenboxç­‰ã€‚
æ¯ä¸€ä¸ªæ¡Œé¢çš„ç¯å¢ƒéƒ½ä¸å°½ç›¸åŒï¼Œå¤§å®¶æ ¹æ®è‡ªå·±çš„å–œæ¬¢è¿›è¡Œé€‰æ‹©å³å¯ï¼
:::